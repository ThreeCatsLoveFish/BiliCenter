<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>push</title>
    <style>
        .theLabels {
            width: 10%;
            float: left;
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
            getEndpoint()
        }

        function getEndpoint() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/api/push/endpoint/list/");
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4) {
                    var resp = JSON.parse(xhr.responseText);
                    var pos = document.getElementById("pushList");
                    pos.innerHTML += "<tr> <th> Name </th> <th> Type </th> <th> Url </th> <th> Token </th> </tr>";
                    for (var i = 0; i < resp.length; i++) {
                        push = resp[i];
                        var str = "<tr>"
                        for (id in push) str += "<td> " + push[id] + " </td>";
                        str += "</tr>"
                        pos.innerHTML += str;
                    }
                }
            }
            xhr.send(null);
        }

        function addEndpoint() {
            var form = new FormData(document.getElementById("formEndpoint"));
            var data = {
                "name": form.get("name"),
                "type": form.get("type"),
                "url": form.get("url"),
                "token": form.get("token"),
            };
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/api/push/endpoint/add/");
            xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
            xhr.send(JSON.stringify(data));
            getEndpoint();
        }
    </script>
</head>

<body>
    <h1>Push data</h1>
    <table id="pushList" border="1"></table>
    <h3>Add new push data</h3>
    <form id="formEndpoint">
        <label class="theLabels">Name:</label> <input type="text" name="name"><br>
        <label class="theLabels">Type:</label> <input type="text" name="type"><br>
        <label class="theLabels">Url:</label> <input type="text" name="url"> <br>
        <label class="theLabels">Token:</label> <input type="password" name="token"> <br>
        <input type="submit" value="addEndpoint" onclick="addEndpoint()">
    </form>
</body>

</html>